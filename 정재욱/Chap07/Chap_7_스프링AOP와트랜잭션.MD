## ìŠ¤í”„ë§ AOPì™€ @Trascational ì†Œê°œ
### AOPë€?
> AOPëŠ” ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ í•µì‹¬ì ì¸ ê¸°ëŠ¥ì—ì„œ ë¶€ê°€ì ì¸ ê¸°ëŠ¥ì„ ë¶„ë¦¬í•´ì„œ ì• ìŠ¤í™íŠ¸ë¼ëŠ” ë…íŠ¹í•œ ëª¨ë“ˆë¡œ ë§Œë“¤ì–´ì„œ ì„¤ê³„í•˜ê³  ê°œë°œí•˜ëŠ” ë°©ë²•ì´ë‹¤.

![image](https://user-images.githubusercontent.com/55322459/179388392-c67dd06a-c3bd-41e3-aef0-57dfc48c0744.png)
- í•µì‹¬ ê¸°ëŠ¥ì˜ ê³µí†µ ë©”ì„œë“œë¥¼ ì¶”ì¶œí•´ì„œ ìƒˆë¡œìš´ ë¶€ê°€ê¸°ëŠ¥ì„ ë§Œë“œëŠ” ê²ƒì´ AOPì´ë‹¤.

### Spring AOP ìš©ì–´ ì •ë¦¬
> íƒ€ê²Ÿ (Target)
- ë¶€ê°€ ê¸°ëŠ¥ì„ ë¶€ì—¬í•  ëŒ€ìƒì„ ì–˜ê¸°í•œë‹¤.
- ì—¬ê¸°ì„  í•µì‹¬ ê¸°ëŠ¥ì„ ë‹´ë‹¹í•˜ëŠ” getBoards, getUsers, Serviceë“±ì„ ì–˜ê¸°í•œë‹¤.

> ì• ìŠ¤í™íŠ¸ (Aspect)
- ê°ì²´ì§€í–¥ ëª¨ë“ˆì„ ì˜¤ë¸Œì íŠ¸ë¼ ë¶€ë¥´ëŠ”ê²ƒê³¼ ë¹„ìŠ·í•˜ê²Œ ë¶€ê°€ê¸°ëŠ¥ ëª¨ë“ˆì„ ì• ìŠ¤í™íŠ¸ë¼ê³  ë¶€ë¥¸ë‹¤.
- __í•µì‹¬ê¸°ëŠ¥ì— ë¶€ê°€ë˜ì–´ ì˜ë¯¸ë¥¼ ê°–ëŠ”__ íŠ¹ë³„í•œ ëª¨ë“ˆì´ë¼ ìƒê°í•˜ë©´ëœë‹¤.
- ì• ìŠ¤í™íŠ¸ëŠ” ë¶€ê°€ë  ê¸°ëŠ¥ì„ ì •ì˜í•œ __ì–´ë“œë°”ì´ìŠ¤__ ì™€ ì–´ë“œë°”ì´ìŠ¤ë¥¼ ì–´ë””ì— ì ìš©í• ì§€ë¥¼ ê²°ì •í•˜ëŠ” __í¬ì¸íŠ¸ì»·__ ì„ í•¨ê»˜ ê°–ê³  ìˆë‹¤.

> í¬ì¸íŠ¸ì»· (PointCut)
- ë¶€ê°€ê¸°ëŠ¥ì´ ì ìš©ë  ëŒ€ìƒ(ë©”ì„œë“œ)ë¥¼ ì„ ì •í•˜ëŠ” ë°©ë²•ì„ ì–˜ê¸°í•œë‹¤.
- ì¦‰, ì–´ë“œë°”ì´ìŠ¤ë¥¼ ì ìš©í•  ì¡°ì¸í¬ì¸íŠ¸ë¥¼ ì„ ë³„í•˜ëŠ” ê¸°ëŠ¥ì„ ì •ì˜í•˜ëŠ” ëª¨ë“ˆì„ ì–˜ê¸°í•œë‹¤.

> ì¡°ì¸í¬ì¸íŠ¸ (JoinPoint)
- ì–´ë“œë°”ì´ìŠ¤ê°€ ì ìš©ë  ìˆ˜ ìˆëŠ” ìœ„ì¹˜ë¥¼ ì–˜ê¸°í•œë‹¤.
- Springì—ì„œëŠ” ë©”ì†Œë“œ ì¡°ì¸í¬ì¸íŠ¸ë§Œ ì œê³µí•˜ê³  ìˆë‹¤.
- ë”°ë¼ì„œ, Springí”„ë ˆì„ì›Œí¬ ë‚´ì—ì„œ ì¡°ì¸í¬ì¸íŠ¸ë¼ í•˜ë©´ ë©”ì†Œë“œë¥¼ ê°€ë¦¬í‚¨ë‹¤ê³  ìƒê°í•´ë„ ëœë‹¤.

> í”„ë¡ì‹œ (Proxy)
- íƒ€ê²Ÿì„ ê°ì‹¸ì„œ íƒ€ê²Ÿì˜ ìš”ì²­ì„ ëŒ€ì‹  ë°›ì•„ì£¼ëŠ” ë©í•‘(Wrapping)ì˜¤ë¸Œì íŠ¸ ì´ë‹¤.
- í˜¸ì¶œì(í´ë¼ì´ì–¸íŠ¸)ì—ì„œ íƒ€ê²Ÿì„ í˜¸ì¶œí•˜ê²Œ ë˜ë©´ íƒ€ê²Ÿì´ ì•„ë‹Œ íƒ€ê²Ÿì„ ê°ì‹¸ê³  ìˆëŠ” í”„ë¡ì‹œê°€ í˜¸ì¶œë˜ì–´, íƒ€ê²Ÿ ë©”ì„œë“œ ì‹¤í–‰ì „ì— ì„ ì²˜ë¦¬, íƒ€ê²Ÿ ë©”ì„œë“œ ì‹¤í–‰ í›„, í›„ì²˜ë¦¬ë¥¼ ì‹¤í–‰ì‹œí‚¤ë„ë¡ êµ¬ì„±ë˜ì–´ìˆë‹¤.

> ì¸íŠ¸ë¡œë•ì…˜ (Introduction)
- íƒ€ê²Ÿ í´ë˜ìŠ¤ì— ì½”ë“œ ë³€ê²½ì—†ì´ ì‹ ê·œ ë©”ì„œë“œë‚˜ ë©¤ë²„ë³€ìˆ˜ë¥¼ ì¶”ê°€í•˜ëŠ” ê¸°ëŠ¥ì„ ì–˜ê¸°í•œë‹¤.

> ìœ„ë¹™ (Weaving)
- ì§€ì •ëœ ê°ì²´ì— ì• ìŠ¤í™íŠ¸ë¥¼ ì ìš©í•´ì„œ ìƒˆë¡œìš´ í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê³¼ì •ì„ ì–˜ê¸°í•œë‹¤.
- ex) Aë¼ëŠ” ê°ì²´ì— íŠ¸ëœì­ì…˜ ì• ìŠ¤íŒ©íŠ¸ê°€ ì§€ì •ë˜ì–´ ìˆë‹¤ë©´, Aë¼ëŠ” ê°ì²´ê°€ ì‹¤í–‰ë˜ê¸°ì „ ì»¤ë„¥ì…˜ì„ ì˜¤í”ˆí•˜ê³  ì‹¤í–‰ì´ ëë‚˜ë©´ ì»¤ë„¥ì…˜ì„ ì¢…ë£Œí•˜ëŠ” ê¸°ëŠ¥ì´ ì¶”ê°€ëœ í”„ë¡ì‹œ ê°ì²´ê°€ ìƒì„±ë˜ê³ , ì´ í”„ë¡ì‹œ ê°ì²´ê°€ ì•ìœ¼ë¡œ Aê°ì²´ê°€ í˜¸ì¶œë˜ëŠ” ì‹œì ì—ì„œ ì‚¬ìš©ëœë‹¤.
- ì´ë•Œì˜ í”„ë¡ì‹œ ê°ì²´ê°€ ìƒì„±ë˜ëŠ” ê³¼ì •ì„ ìœ„ë¹™ì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.
- Aspectê°€ targetì— ì ìš©ë˜ëŠ” ì „ì²´ì ì¸ ê³¼ì •ì„ ë§í•œë‹¤. ì¦‰, Pointcutìœ¼ë¡œ ì§€ì •ëœ JoinPointì— Adviceê°€ ì ìš©ë˜ì–´ Targetì„ í˜¸ì¶œ ì‹œ AOP Proxyê°€ ë§Œë“¤ì–´ì§€ëŠ” ê³¼ì •ì´ë‹¤.

#### AOPë¥¼ ì´ìš©í•œ íŠ¸ëœì­ì…˜ ë¶„ë¦¬

> íŠ¸ëœì­ì…˜ì„ ì ìš©í•˜ì§€ ì•Šì€ ì½”ë“œ
```java
public class FakeService {
    private final PlatformTransactionManager transactionManager;
    private final CrewDao crewDao;
    
    public FakeService(PlatformTransactionManager transactionManager, CrewDao crewDao) {
        this.transactionManager =  transactionManager;
        this.crewDao = crewDao;
    }
    
    public void addCrew(String str) {
        final TransactionStatus status = transactionManager.getTransaction(new DefaultTransactionDefinition());
        
        try{
            List<Crew> crews = crewDao.findAll();
            for (Crew crew : crews) {
                if(crew.isNotDup()) {
                    crewDao.addCrew(crew, str);
                }
            }
            
            transactionManager.commit(status);
        } catch (RuntimeException e) {
            transactionManager.rollback(status);
            throw e;
        }
    }
}
```
- ìœ„ì˜ ì½”ë“œëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ê³  ì™„ë£Œí•˜ë©´ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê³ , ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ë¡¤ë°±ë˜ëŠ” ì½”ë“œì´ë‹¤.
- íŠ¸ëœì­ì…˜ ê´€ë ¨ ì½”ë“œê°€ ë§¤ë²ˆ ì‘ì„±ë˜ê¸° ë•Œë¬¸ì— ì½”ë“œì˜ ì¤‘ë³µì´ ì¼ì–´ë‚œë‹¤.

> íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ Spring AOPì ìš© ì½”ë“œ 1
```java
@Component
@Aspect
public class TransactionAspect {
    
    @Autowired
    private PlatformTransactionManager transactionManager;
    
    @Pointcut("execution(public void add*(..))")
    private void publicTarget() {
        
    }
    
    @Around("publicTarget()")
    public void transaction(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {
        final TransactionStatus status = transactionManager.getTransaction(new DefaultTransactionDefinition());
        
        try{
            proceedingJoinPoint.proceed();
            transactionManager.commit(status);
        } catch (RuntimeException e) {
            transactionManager.rollback(status);
            throw e;
        }
    }
}
```
- @Around ì–´ë…¸í…Œì´ì…˜ì„ ì´ìš©í•´ì„œ ì‹¤ì œ ëŒ€ìƒì´ ë˜ëŠ” ê°ì²´ë¥¼ ì‹¤í–‰í•œ í›„ ì„±ê³µ ì—¬ë¶€ì— ë”°ë¼ íŠ¸ëœì­ì…˜ì„ commit ë˜ëŠ” rollbackí•´ì¤€ë‹¤.
- @Pointcutì„ ì´ìš©í•´ì„œ ì‹¤ì œ ëŒ€ìƒì´ ë˜ëŠ” íƒ€ê²Ÿì„ ì§€ì •í•´ì¤€ë‹¤.

> íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ Spring AOPì ìš© ì½”ë“œ 2(ì–´ë…¸í…Œì´ì…˜í™”í•˜ê¸°)
```java
@Component
@Aspect
public class TransactionAspect {
    
    @Autowired
    private PlatformTransactionManager transactionManager;
    
//    @Pointcut("execution(public void add*(..))")
//    private void publicTarget() {
//        
//    }
    
    @Around(@annotation(FakeTransactional))
    public void transaction(ProceedingJoinPoint proceedingJoinPoint) throws Throwable {
        final TransactionStatus status = transactionManager.getTransaction(new DefaultTransactionDefinition());
        
        try{
            proceedingJoinPoint.proceed();
            transactionManager.commit(status);
        } catch (RuntimeException e) {
            transactionManager.rollback(status);
            throw e;
        }
    }
}
```

```java
@Target({ElementType.METHOD})
@Rentetion(RetentionPolicy.RUNTIME)
public @interface FakeTransactional {
}
```
```java
@Component
public class FakeServiceImpl implements FakeService {
    private final CrewDao crewDao;
    
    public FakeServiceImpl(CrewDao crewDao) {
        this.crewDao = crewDao;
    }
    
    @Override
    @FakeTransactional
    public void addCrew(String str) {
        List<Crew> crews = crewDao.findAll();
        for(Crew crew : crews) {
            if(crew.isNotDup()) {
                crewDao.addCrew(crew, str);
            }
        }
    }
}
```

> íŠ¸ëœì­ì…˜ì„ ì ìš©í•˜ì§€ ì•Šì€ ì½”ë“œ
```java
public void addUsers(List<User> userList) {
	TransactionStatus status = this.transactionManager.getTransaction(new DefaultTransactionDefinition());
	
	try {
		for (User user: userList) {
			if(isEmailNotDuplicated(user.getEmail())){
				userRepository.save(user);
			}
		}

		this.transactionManager.commit(status);
	} catch (Exception e) {
		this.transactionManager.rollback(status);
		throw e
	}
}
```
- ìœ„ì˜ ì½”ë“œëŠ” ì—¬ëŸ¬ ì±…ì„ì„ ê°€ì§ˆ ë¿ë§Œ ì•„ë‹ˆë¼ ì„œë¡œ ì„±ê²©ë„ ë‹¤ë¥´ê³  ì£¼ê³ ë°›ëŠ” ê²ƒë„ ì—†ìœ¼ë¯€ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ ì í•©í•˜ë‹¤.
- Springì—ì„œëŠ” ë§ˆì¹˜ íŠ¸ëœì­ì…˜ ì½”ë“œì™€ ê°™ì€ ë¶€ê°€ ê¸°ëŠ¥ ì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒ ì²˜ëŸ¼ ë³´ì´ê¸° ìœ„í•´ __í•´ë‹¹ ë¡œì§ì„ í´ë˜ìŠ¤ ë°–ìœ¼ë¡œ ë¹¼ë‚´ì„œ ë³„ë„ì˜ ëª¨ë“ˆë¡œ ë§Œë“œëŠ” AOP__ ë¥¼ ê³ ì•ˆ ë° ì ìš©í•˜ê²Œ ë˜ì—ˆë‹¤.
- ì´ë¥¼ ì ìš©í•œ íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜(@Transactional)ì„ ì§€ì›í•˜ê²Œ ë˜ì—ˆë‹¤.

> íŠ¸ëœì­ì…˜ì„ ì ìš©í•œ AOPë°©ë²•ì˜ ì½”ë“œ
```java
@Service
@RequiredArgsConstructor
@Transactional
public class UserService {

    private final UserRepository userRepository;

    public void addUsers(List<User> userList) {
        for (User user : userList) {
            if (isEmailNotDuplicated(user.getEmail())) {
                userRepository.save(user);
            }
        }
    }
}
```
- íŠ¹ë³„í•˜ê²Œ íŠ¸ëœì­ì…˜ì„ ì½”ë“œë¡œ commití•˜ê³  rollbackí•˜ê±°ë‚˜ í•˜ëŠ” ì½”ë“œê°€ ë³´ì´ì§€ ì•Šì•„ ì½”ë“œê°€ ê°„ê²°í•˜ë‹¤.
- UserServiceë¼ëŠ” ë„ë©”ì¸ì— ë§ê²Œ ìœ ì €ë¥¼ ì¶”ê°€í•˜ëŠ” ë‚´ìš©ì˜ ì½”ë“œë§Œ ì‘ì„±ë˜ì–´ ìˆì–´ ë„ë©”ì¸ì˜ ê¸°ëŠ¥ì— ì¶©ì‹¤í•˜ê³  ìˆë‹¤.

### Transactionê³¼ @Transactional ì–´ë…¸í…Œì´ì…˜ ì†Œê°œ
#### Transactionì´ë€?
> íŠ¸ëœì­ì…˜ì´ë€ DBì˜ ì¿¼ë¦¬ë¥¼ ë‚ ë ¤ì„œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ create, insert, select, update, delete ë“±ì˜ ì‘ì—…ì„ í•˜ëŠ” ê°€ì¥ ìµœì†Œ ë‹¨ìœ„ë¥¼ íŠ¸ëœì­ì…˜ì´ë¼ê³  í•œë‹¤.

#### Transactionì— ì´í•´ í•„ìš”ì„±
ë°ì´í„°ë² ì´ìŠ¤ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ëŠ” ë„ì¤‘ì— ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ? DBì˜ ë°ì´í„°ë“¤ì€ ìˆ˜ì •ì´ ë˜ê¸° ì „ì˜ ìƒíƒœë¡œ ë‹¤ì‹œ ë˜ëŒì•„ê°€ì ¸ì•¼ í•˜ê³ , ë‹¤ì‹œ ìˆ˜ì • ì‘ì—…ì´ ì§„í–‰ë˜ì–´ì•¼ í•œë‹¤.
ì´ë ‡ë“¯ __ì—¬ëŸ¬ ì‘ì—…ì„ ì§„í–‰í•˜ë‹¤ê°€ ë¬¸ì œê°€ ìƒê²¼ì„ ê²½ìš° ì´ì „ ìƒíƒœë¡œ ë¡¤ë°±í•˜ê¸° ìœ„í•´ ì‚¬ìš©__ ë˜ëŠ”ê²ƒì´ íŠ¸ëœì­ì…˜ì´ë‹¤.

#### íŠ¸ëœì­ì…˜ì˜ í•„ìš”ì„±ì— ëŒ€í•œ ì…ì¶œê¸ˆ ì˜ˆì‹œ
![image](https://user-images.githubusercontent.com/55322459/179398533-5d10ab96-224f-44a0-bba7-6482a13d19da.png)
 - ë³‘ì•„ë¦¬ë¥¼ A íŒŒë„ë¥¼ Bë¼ê³  í•˜ì˜€ì„ ë•Œ, Aê°€ Bì—ê²Œ ì…ê¸ˆì„ í•˜ëŠ” ìƒí™©ì—ì„œ Aì˜ ì”ì•¡ì€ 10000ì›ìœ¼ë¡œ updateí•˜ê³ , Bì˜ ì”ì•¡ì„ 60000ì›ìœ¼ë¡œ updateí•˜ëŠ” ê³¼ì •ì—ì„œ ì„œë²„ì˜ ë‹¤ìš´ì´ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì¥ì• ê°€ ë°œìƒí•˜ëŠ”ê²ƒì„ ë°©ì§€í•˜ê³ ì íŠ¸ëœì­ì…˜ì´ í•„ìš”í•˜ë‹¤.
 - íŠ¸ëœì­ì…˜ì€ ì¼ë¶€ë§Œ ì‹¤í–‰í•˜ê³  ì‹¤íŒ¨í•˜ëŠ” ì´ëŸ¬í•œ ê³¼ì •ì—†ì´ í•˜ë‚˜ë¡œ ë¬¶ì–´ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.
 - ì˜ˆë¥¼ ë“¤ì–´ ì”ì•¡ì„ Aì˜ ì”ì•¡ì„ 20000ì› ì—ì„œ 10000ì›ìœ¼ë¡œ ì°¨ê° í–ˆì§€ë§Œ, ì„œë²„ì˜ ì¥ì• ë¡œ Bì˜ ì”ì•¡ì„ 50000ì›ì—ì„œ 60000ì›ìœ¼ë¡œ updateë¥¼ í•´ì£¼ì§€ ì•Šì•˜ë‹¤ë©´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì—ì„œ Aì˜ ì”ì•¡ì€ ì„±ê³µí–ˆì§€ë§Œ ì „ì²´ì ìœ¼ë¡œ ì‹¤íŒ¨ í–ˆë‹¤ê³  í•˜ì—¬ rollbackì²˜ë¦¬í•œë‹¤.

### íŠ¸ëœì­ì…˜ (Transaction)
#### ì„ ì–¸ì  íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ì˜ˆì‹œ

![image](https://user-images.githubusercontent.com/55322459/179398923-4d8bdc22-7851-4d6f-bf63-1ca6987f2e88.png)
  - íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ì€ ë©”ì„œë“œ, í´ë˜ìŠ¤, ì¸í„°í˜ì´ìŠ¤ ë“±ì— ì ìš©í•  ìˆ˜ ìˆë‹¤.
  - í´ë˜ìŠ¤ ìƒë‹¨ì— ì ìš©í•˜ëŠ” ì–´ë…¸í…Œì´ì…˜ì—ì„œëŠ” í•´ë‹¹ í´ë˜ìŠ¤ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  ë©”ì„œë“œì— ì–´ë…¸í…Œì´ì…˜ì´ ì ìš©ëœë‹¤.
  - ì¤‘ì²©ë˜ì–´ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ëŠ” 
    - 1.í´ë˜ìŠ¤ ë©”ì„œë“œ, 2.í´ë˜ìŠ¤ ìˆœìœ¼ë¡œ ìš°ì„ ìˆœìœ„ë¥¼ ê°–ê³  ì ìš©ëœë‹¤.
    - 1.ì¸í„°í˜ì´ìŠ¤ ë©”ì„œë“œ, 2.ì¸í„°í˜ì´ìŠ¤ ìˆœìœ¼ë¡œ ìš°ì„ ìˆœìœ„ë¥¼ ê°–ê³  ì ìš©ëœë‹¤.
  - ë©”ì„œë“œë¥¼ ì‹œì‘í•˜ëŠ” ìˆœê°„ íŠ¸ëœì­ì…˜ì´ ì‹œì‘ë˜ê³ , ë©”ì„œë“œë¥¼ ì„±ê³µì ìœ¼ë¡œ ëë§ˆì¹˜ë©´ íŠ¸ëœì­ì…˜ ì»¤ë°‹
  - ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì¤‘ê°„ì— ë¬¸ì œê°€ ë°œìƒí•˜ë©´ ë¡¤ë°±í•˜ëŠ” ê³¼ì •ìœ¼ë¡œ ì§„í–‰ëœë‹¤.
  - í•˜ë‚˜ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì„œë¹„ìŠ¤ ê³„ì¸µ ë©”ì„œë“œì— ë¶™ì´ëŠ” ê²ƒì´ í†µìƒì ì´ë‹¤.

#### ì‹¤ì œ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì— íŠ¸ëœì­ì…˜ ì˜µì…˜
![image](https://user-images.githubusercontent.com/55322459/179402147-bf8a7c2d-fe0a-417d-ba3d-c545b8474c2c.png)
 - íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì € ë˜í•œ ì†ì„±ìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆë‹¤. ë¹ˆìœ¼ë¡œ ë“±ë¡ëœ íŠ¹ìˆ˜í•œ íŠ¸ëœì­ì…˜ ë§¤ë‹ˆì €ë¥¼ ì†ì„±ìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆë‹¤.

### @Transactional - propagation
 > íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ê±°ë‚˜ ê¸°ì¡´ íŠ¸ëœì­ì…˜ì— ì°¸ì—¬í•˜ëŠ” ë°©ë²•ì„ ê²°ì •í•˜ëŠ” ì†ì„±
> 
> íŠ¸ëœì­ì…˜ ê²½ê³„ì„¤ì • ë°©ì‹ì˜ ì¥ì ì€ ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ ì ìš© ë²”ìœ„ë¥¼ ë¬¶ì–´ì„œ ì»¤ë‹¤ë€ íŠ¸ëœì­ì…˜ ê²½ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.
> 
> íŠ¸ëœ ì­ì…˜ ê²½ê³„ì˜ ì‹œì‘ ì§€ì ì—ì„œ íŠ¸ëœì­ì…˜ ì „íŒŒ ì†ì„±ì„ ì°¸ì¡°í•´ì„œ í•´ë‹¹ ë²”ìœ„ì˜ íŠ¸ëœì­ì…˜ì„ ì–´ë–¤ ì‹ìœ¼ë¡œ ì§„í–‰ì‹œí‚¬ì§€ ê²°ì •í•  ìˆ˜ ìˆë‹¤.

####@Transactional(propagation=Propagation.REQUIRED)

 >ë©”ì„œë“œ1 -> íŠ¸ëœì­ì…˜1 ìƒì„±

![image](https://user-images.githubusercontent.com/55322459/179402112-875cb16e-58f6-4e34-b84b-eca924fa015d.png)

> ë©”ì„œë“œ2 -> íŠ¸ëœì­ì…˜2 ìƒì„±

![image](https://user-images.githubusercontent.com/55322459/179402090-0599c8d7-3a60-46df-ae9e-cd8638dd6aae.png)
- ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ì—†ì„ ê²½ìš° ë©”ì„œë“œ1ì€ íŠ¸ëœì­ì…˜1ë¡œ ì‹œì‘ë˜ê³ , ì¤‘ê°„ì— ë©”ì„œë“œ2ê°€ ì¶”ê°€ë˜ì„œ íŠ¸ëœì­ì…˜2ê°€ ë˜ë©´ ì•„ë˜ì˜ ê·¸ë¦¼ ì²˜ëŸ¼ íŠ¸ëœì­ì…˜1ì— ì¶”ê°€ë˜ì–´ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì‹¤í–‰ ë˜ê²Œ ëœë‹¤.
- í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ ì‹¤íŒ¨í•˜ë©´ íŠ¸ëœì­ì…˜1,2 ëª¨ë‘ ë¡¤ë°±ë˜ê³ , 2ê°œì˜ íŠ¸ëœì­ì…˜ì´ ëª¨ë‘ ì„±ê³µí•˜ë©´ 2ê°œì˜ íŠ¸ëœì­ì…˜ ëª¨ë‘ commitëœë‹¤.

__ìš”ì•½__ : ë””í´íŠ¸ê°’ìœ¼ë¡œ ë¯¸ë¦¬ ì‹œì‘ëœ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ì°¸ì—¬í•˜ê³  ì—†ìœ¼ë©´ ìƒˆë¡œ ì‹œì‘í•œë‹¤.

#### ğŸ”¶ 1. @Transactional(propagation=Propagation.SUPPORTS)

![image](https://user-images.githubusercontent.com/55322459/179402084-1cfe03d7-fe8c-4b17-bf93-caa9efeb20cb.png)
__ìš”ì•½__ : ì´ë¯¸ ì‹œì‘ëœ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ì°¸ì—¬í•˜ê³ , ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ íŠ¸ëœì­ì…˜ ì—†ì´ ì§„í–‰í•œë‹¤. íŠ¸ëœì­ì…˜ì´ ì—†ê¸´ í•˜ì§€ë§Œ í•´ë‹¹ ê²½ê³„ ì•ˆì—ì„œ Connectionì´ë‚˜ í•˜ì´ë²„ë„¤ì´íŠ¸ Sessionë“±ì„ ê³µìœ í•  ìˆ˜ ìˆë‹¤.

#### ğŸ”¶ 2. @Transactional(propagation=Propagation.MANDATORY)

![image](https://user-images.githubusercontent.com/55322459/179402043-a429f301-30f7-4d33-912f-6ef0863dc2ce.png)
 - ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ì°¸ì—¬í•˜ê³ , ì—†ìœ¼ë©´ ì˜ˆì™¸ê°€ ë°œìƒí•œë‹¤.

__ìš”ì•½__ : í˜¼ìì„œëŠ” íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•  ìˆ˜ ì—†ê³ , ë©”ì„œë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ë„ì—†ë‹¤.
ì¦‰, í˜¼ìì„œëŠ” ë…ë¦½ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì§„í–‰í•  ìˆ˜ ì—†ë‹¤. ë…ë¦½ì ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì§„í–‰í•˜ë©´ ì•ˆë˜ëŠ” ê²½ìš° ì‚¬ìš©
 
#### ğŸ”¶ 3. @Transactional(propagation=Propagation.REQUIRES_NEW)

![image](https://user-images.githubusercontent.com/55322459/179402015-a45b7451-d7cf-4d04-b475-d76b4ef07a60.png)
 - ìƒˆë¡œìš´ ë©”ì„œë“œ1ì´ ì‹¤í–‰ë˜ë©´ íŠ¸ëœì­ì…˜1ë¡œ ì‹¤í–‰í•˜ê³ , ìƒˆë¡œìš´ ë©”ì„œë“œ2ê°€ ì‹¤í–‰ë˜ë©´ íŠ¸ëœì­ì…˜1ì„ ë³´ë¥˜í•˜ê³ , íŠ¸ëœì­ì…˜2ë¥¼ ì‹¤í–‰í•œë‹¤.

__ìš”ì•½__ : í•­ìƒ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œë‹¤. ì´ë¯¸ ì§„í–‰ ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ íŠ¸ëœì­ì…˜ì„ ì ì‹œ ë³´ë¥˜ì‹œí‚¨ë‹¤.

#### ğŸ”¶ 4. @Transactional(propagation=Propagation.NOT_SUPPORTED)

![image](https://user-images.githubusercontent.com/55322459/179401980-459a0e9d-5272-42c2-a1ec-90f8b6f93008.png)
 - íŠ¸ëœì­ì…˜1ì´ ì‹¤í–‰ë˜ê³  ìˆë‹¤ë©´ íŠ¸ëœì­ì…˜1ì„ ë³´ë¥˜í•˜ê³  ë©”ì„œë“œ2ë¥¼ ë¨¼ì € ì‹¤í–‰í•œë‹¤. ë©”ì„œë“œ2ëŠ” íŠ¸ëœì­ì…˜2ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤.

__ìš”ì•½__ : íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šê²Œ í•œë‹¤. ì´ë¯¸ ì§„í–‰ ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ë³´ë¥˜ì‹œí‚¨ë‹¤.

#### ğŸ”¶ 5. @Transactional(propagation=Propagation.NEVER)

![image](https://user-images.githubusercontent.com/55322459/179401967-3bd547dd-4c2f-46d6-96a0-dd17fe338f4f.png)
 - ì´ë¯¸ ì‹¤í–‰ë˜ëŠ” íŠ¸ëœì­ì…˜ì´ ì—†ë‹¤ë©´ ì‹¤í–‰í•˜ë ¤ëŠ” ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ì§€ë§Œ, ê¸°ì¡´ì— ì‹¤í–‰ë˜ëŠ” íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•œë‹¤ë©´ ì˜ˆì™¸ë¥¼ ë°œìƒ ì‹œí‚¨ë‹¤.

__ìš”ì•½__ : íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ê°•ì œí•œë‹¤. ì´ë¯¸ ì§„í–‰ ì¤‘ì¸ íŠ¸ëœì­ì…˜ë„ ì¡´ì¬í•˜ë©´ ì•ˆëœë‹¤. ì˜ˆì™¸ë¥¼ ë°œìƒ ì‹œí‚¨ë‹¤.

#### ğŸ”¶ 6. @Transactional(propagation=Propagation.NESTED)

![image](https://user-images.githubusercontent.com/55322459/179401950-7e3cccdc-f08d-43ea-908c-0da6192254e0.png)
 - íŠ¸ëœì­ì…˜1ì„ ì‹¤í–‰í•˜ê³  íŠ¸ëœì­ì…˜2ê°€ ì‹¤í–‰ë˜ëŠ”ê²½ìš° Requiredì™€ ë‹¤ë¥´ê²Œ íŠ¸ëœì­ì…˜1ì´ ì‹¤í–‰ë˜ë‹¤ê°€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ë©´ íŠ¸ë˜ì­ì…˜1ê³¼ 2ëª¨ë‘ ë¡¤ë°±ëœë‹¤.
 - í•˜ì§€ë§Œ, íŠ¸ëœì­ì…˜2ê°€ ë¬¸ì œë¥¼ ë°œìƒí•  ê²½ìš° íŠ¸ëœì­ì…˜1ì€ ì•„ë¬´ ë¬¸ì œì—†ì´ commitëœë‹¤.

__ìš”ì•½__ : ì´ë¯¸ ì§„í–‰ì¤‘ì¸ íŠ¸ëœì­ì…˜ì´ ìˆìœ¼ë©´ ì¤‘ì²© íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•œë‹¤. ì¤‘ì²©ëœ íŠ¸ëœì­ì…˜ì€ ë¨¼ì € ì‹œì‘ëœ ë¶€ëª¨ íŠ¸ëœì­ì…˜ì˜ ì»¤ë°‹ê³¼ ë¡¤ë°±ì—ëŠ” ì˜í–¥ì„ ë°›ì§€ë§Œ ìì‹ ì˜ ì»¤ë°‹ê³¼ ë¡¤ë°±ì€ ë¶€ëª¨ íŠ¸ëœì­ì…˜ì—ê²Œ ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.

#### íŠ¸ëœì­ì…˜ ì „íŒŒ ì •ë¦¬
![image](https://user-images.githubusercontent.com/55322459/179401806-b1a16375-feb9-4b7e-8fa9-deca63619ea2.png)

### íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ (Isolation)
![image](https://user-images.githubusercontent.com/55322459/179401928-c528b142-1e2d-489e-ba68-1422222252d6.png)
 > íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€ ì•„ë˜ë¡œ ê°ˆìˆ˜ë¡ ê²©ë¦¬ìˆ˜ì¤€ì€ ì˜¬ë¼ê°€ì§€ë§Œ, ì„±ëŠ¥ì´ ë–¨ì–´ì§„ë‹¤.
 > ë°ì´í„° ì •í•©ì„±ê³¼ ì„±ëŠ¥ì€ ë°˜ë¹„ë¡€í•œë‹¤.

#### ğŸŸ¢ 1. READ-UNCOMMITTED
> ì»¤ë°‹ ì „ì˜ íŠ¸ëœì­ì…˜ì˜ ë°ì´í„° ë³€ê²½ ë‚´ìš©ì„ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ì½ëŠ” ê²ƒì„ í—ˆìš©

![image](https://user-images.githubusercontent.com/55322459/179401900-1a61d149-706e-44a4-9f99-30968392ee87.png)

> ë”í‹°ë¦¬ë“œ(Dirty Read)ë¼ëŠ” í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
 - íŠ¸ëœì­ì…˜ Aê°€ íŠ¸ëœì­ì…˜ì„ ëë§ˆì¹˜ì§€ ëª»í•˜ê³  Rollbackì´ ë˜ì—ˆë‹¤ë©´
 - íŠ¸ëœì­ì…˜ BëŠ” ë¬´íš¨ê°€ëœ ê°’ì„ ì½ê³  ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.

#### ğŸŸ¢ 2. READ-COMMITTED
> ì»¤ë°‹ì´ ì™„ë£Œëœ íŠ¸ëœì­ì…˜ì˜ ë³€ê²½ì‚¬í•­ë§Œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì¡°íšŒ ê°€ëŠ¥
 íŠ¸ëœ ì­ì…˜ì´ ì´ë£¨ì–´ì§€ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‚¬ìš©ìëŠ” í•´ë‹¹ ë°ì´í„°ì— ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤.

![image](https://user-images.githubusercontent.com/55322459/179401851-0ddfaba5-5aaa-4464-a0a8-d41e49a306ae.png)

> ë…¼ë¦¬í”¼í„°ë¸”ë¦¬ë“œ(Non-Repeatable Read) ë¬¸ì œ
 - íŠ¸ëœì­ì…˜ Bì—ì„œ ë‹¤ë¥¸ ì‹œì ì— ì¡°íšŒ í–ˆì„ ë•Œ ë°ì´í„°ê°€ ë‹¤ë¥¸ê°’ì´ ë  ê²½ìš°ì— ëŒ€í•œ ë¬¸ì œ
 - ë°ì´í„° ë¶ˆì¼ì¹˜ì— ëŒ€í•œ ë¬¸ì œ
 
#### ğŸŸ¢ 3. REPEATABLE-READ
> íŠ¸ëœì­ì…˜ ë²”ìœ„ ë‚´ì—ì„œ ì¡°íšŒí•œ ë‚´ìš©ì´ í•­ìƒ ë™ì¼í•¨ì„ ë³´ì¥

![image](https://user-images.githubusercontent.com/55322459/179401829-b46c1b69-b04c-4f9d-b8ee-0b71380f61ca.png)
 - Non-Repeatable Readë¬¸ì œë¥¼ ë°©ì§€í•œë‹¤.
 - í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ ì½ì€ ë¡œìš°ë¥¼ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ìˆ˜ì •í•˜ëŠ” ê²ƒì„ ë§‰ì•„ì¤€ë‹¤.
 - í•˜ì§€ë§Œ ìƒˆë¡œìš´ ë¡œìš°ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì€ ì œí•œí•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ selectë¡œ ì¡°ê±´ì— ë§ëŠ” ë¡œìš°ë¥¼ ì „ë¶€ ê°€ì ¸ì˜¤ëŠ” ê²½ìš° íŠ¸ëœì­ì…˜ì´ ëë‚˜ê¸° ì „ì— ì¶”ê°€ëœ ë¡œìš°ê°€ ë°œê²¬ë  ìˆ˜ ìˆë‹¤.

> íŒ¬í…€ë¦¬ë“œ(Phantom Read)ë¬¸ì œ
 - ë‹¤ë¥¸ ì‹œì ì— ì¡°íšŒí–ˆì„ ê²½ìš° ìƒˆë¡œìš´ í–‰ì´ ì¶”ê°€ë˜ì—ˆê±°ë‚˜, ì‚­ì œë˜ëŠ” ë¬¸ì œ

#### ğŸŸ¢ 4. SERIALIZABLE
> í•œ íŠ¸ëœì­ì…˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ë¥¼ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì ‘ê·¼ ë¶ˆê°€
 - íŠ¸ëœì­ì…˜ì„ ìˆœì°¨ì ìœ¼ë¡œ ì§„í–‰ì‹œì¼œ ì£¼ê¸° ë•Œë¬¸ì— ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì´ ë™ì‹œì— ê°™ì€ í…Œì´ë¸”ì˜ ì •ë³´ë¥¼ ì•¡ì„¸ìŠ¤ í•˜ì§€ëª»í•œë‹¤.
 - ê°€ì¥ ì•ˆì „í•œ ê²©ë¦¬ ìˆ˜ì¤€ì´ì§€ë§Œ ê°€ì¥ ì„±ëŠ¥ì´ ë–¨ì–´ì§€ê¸° ë•Œë¬¸ì— ê·¹ë‹¨ì ì¸ ì•ˆì „í•œ ì‘ì—…ì´ ì•„ë‹ê²½ìš° ìì£¼ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.

#### íŠ¸ëœì­ì…˜ ì†ì„±ì— ë”°ë¥¸ ë¬¸ì œì ë“¤ ì •ë¦¬
![image](https://user-images.githubusercontent.com/55322459/179401764-212ca5e9-59d2-42f0-b421-1ce4e5bbb04a.png)
