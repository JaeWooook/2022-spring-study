## Chapter5 ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”
> ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì´ë€?

> ìŠ¤í”„ë§ì´ ì§ì ‘ í´ë˜ìŠ¤ë¥¼ ê²€ìƒ‰í•´ì„œ ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì£¼ëŠ” ê¸°ëŠ¥ì´ë‹¤.
> ì„¤ì • í´ë˜ìŠ¤(AppCtxí´ë˜ìŠ¤)ì— ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ì§€ ì•Šì•„ë„ ì›í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë©´ ì„¤ì • ì½”ë“œê°€ í¬ê²Œ ì¤„ì–´ë“ ë‹¤.

### @Component ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ìŠ¤ìº” ëŒ€ìƒ ì§€ì •
- ìŠ¤í”„ë§ì´ ê²€ìƒ‰í•´ì„œ ë¹ˆìœ¼ë¡œ ë“±ë¡í•  ìˆ˜ ìˆìœ¼ë ¤ë©´ í´ë˜ìŠ¤ì— @Component ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì•¼í•œë‹¤.
- @Component ì• ë…¸í…Œì´ì…˜ì€ í•´ë‹¹ í´ë˜ìŠ¤ë¥¼ ìŠ¤ìº” ëŒ€ìƒìœ¼ë¡œ í‘œì‹œí•œë‹¤.

#### Componet ì• ë…¸í…Œì´ì…˜ì„ ìƒì„±í•  ë¹ˆ í´ë˜ìŠ¤ì— ë¶™ì¸ ì˜ˆì‹œ
```java
package spring;

import java.util.Collection;
import java.util.HashMap;
import java.util.Map;

import org.springframework.stereotype.Component;

@Component
public class MemberDao {

	private static long nextId = 0;

	private Map<String, Member> map = new HashMap<>();

	public Member selectByEmail(String email) {
		return map.get(email);
	}

	public void insert(Member member) {
		member.setId(++nextId);
		map.put(member.getEmail(), member);
	}

	public void update(Member member) {
		map.put(member.getEmail(), member);
	}

	public Collection<Member> selectAll() {
		return map.values();
	}
}
```
- ChangePasswordService í´ë˜ìŠ¤ì™€ MemberRegisterService í´ë˜ìŠ¤ì—ë„ ë™ì¼í•˜ê²Œ @Component ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ë‹¤.

```java
package spring;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.stereotype.Component;

@Component("infoPrinter")
public class MemberInfoPrinter {

	private MemberDao memDao;
	private MemberPrinter printer;

    ...

}
```
- @Component ì• ë…¸í…Œì´ì…˜ ê°’ì„ ì£¼ì§€ì•Šìœ¼ë©´ í´ë˜ìŠ¤ ì´ë¦„ì´ MemberDao ì´ë©´ -> __ë¹ˆ(ë¹ˆ ê°ì²´)__ ì´ë¦„ì€ memberDaoê°€ ëœë‹¤.
- ìœ„ì˜ ì½”ë“œì²˜ëŸ¼ @Component ì• ë…¸í…Œì´ì…˜ì— ê°’ì„ ì£¼ë©´ ê·¸ ê°’ì„ __ë¹ˆ(ë¹ˆ ê°ì²´)__ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. MemberInfoPrinter -> infoPrinterê°€ __ë¹ˆ(ë¹ˆ ê°ì²´)__ ì´ë¦„ì´ ëœë‹¤.
- ë‚˜ë¨¸ì§€ ë¹ˆì„ ìƒì„±í•  í´ë˜ìŠ¤ë„ ë™ì¼í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ex) MemberListPrinter, ... ë“±

### @ComponentScan ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ìŠ¤ìº” ì„¤ì •
 - @Component ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ í´ë˜ìŠ¤ë¥¼ ìŠ¤ìº”í•´ì„œ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ë ¤ë©´ ì„¤ì • í´ë˜ìŠ¤ì— @ComponentScan ì• ë…¸í…Œì´ì…˜ì„ ì ìš©í•´ì•¼ í•œë‹¤.

#### âœ… ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ì‚¬ìš© ì˜ˆì‹œ ì„¤ì •ì½”ë“œ
```java
package config;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;

import spring.MemberPrinter;
import spring.MemberSummaryPrinter;
import spring.VersionPrinter;

@Configuration
@ComponentScan(basePackages = {"spring"})
public class AppCtx {

	@Bean
	@Qualifier("printer")
	public MemberPrinter memberPrinter1() {
		return new MemberPrinter();
	}

	@Bean
	@Qualifier("summaryPrinter")
	public MemberSummaryPrinter memberPrinter2() {
		return new MemberSummaryPrinter();
	}

	@Bean
	public VersionPrinter versionPrinter() {
		VersionPrinter versionPrinter = new VersionPrinter();
		versionPrinter.setMajorVersion(5);
		versionPrinter.setMinorVersion(0);
		return versionPrinter;
	}
}
```
 - @ComponentScan ì• ë…¸í…Œì´ì…˜ì˜ basePackages ì†ì„±ê°’ì€ {"spring"}ì´ë‹¤.
 - ì´ ì†ì„±ì€ ìŠ¤ìº” ëŒ€ìƒ íŒ¨í‚¤ì§€ ëª©ë¡ì„ ì§€ì •í•œë‹¤.
 - springê°’ í•œê°œë§Œ ì¡´ì¬í•˜ëŠ” ì´ìœ ëŠ” spring íŒ¨í‚¤ì§€(ex)trimoryì—ì„œëŠ” comë˜ëŠ” com.backendë¡œ í•˜ë©´ ê·¸ í•˜ìœ„ íŒ¨í‚¤ì§€ë“¤ì„ ê²€ìƒ‰í•œë‹¤.)ì™€ ê·¸ í•˜ìœ„ íŒ¨í‚¤ì§€ì— ì†í•œ í´ë˜ìŠ¤ë¥¼ ìŠ¤ìº” ëŒ€ìƒìœ¼ë¡œ ì„¤ì •í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
 - ìŠ¤ìº” ëŒ€ìƒì— í•´ë‹¹í•˜ëŠ” í´ë˜ìŠ¤ ì¤‘ì—ì„œ @Component ì• ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ì˜ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ë¹ˆìœ¼ë¡œ ë“±ë¡í•œë‹¤.

#### âŒ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ ì‚¬ìš©í•˜ì§€ ì•Šì€ ì˜ˆì‹œ ì„¤ì •ì½”ë“œ
```java
package config;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import spring.ChangePasswordService;
import spring.MemberDao;
import spring.MemberInfoPrinter;
import spring.MemberListPrinter;
import spring.MemberPrinter;
import spring.MemberRegisterService;
import spring.MemberSummaryPrinter;
import spring.VersionPrinter;

@Configuration
public class AppCtx {

	@Bean
	public MemberDao memberDao() {
		return new MemberDao();
	}
	
	@Bean
	public MemberRegisterService memberRegSvc() {
		return new MemberRegisterService();
	}
	
	@Bean
	public ChangePasswordService changePwdSvc() {
		return new ChangePasswordService();
	}
	
	@Bean
	@Qualifier("printer")
	public MemberPrinter memberPrinter1() {
		return new MemberPrinter();
	}
	
	@Bean
	@Qualifier("summaryPrinter")
	public MemberSummaryPrinter memberPrinter2() {
		return new MemberSummaryPrinter();
	}
	
	@Bean
	public MemberListPrinter listPrinter() {
		return new MemberListPrinter();
	}
	
	@Bean
	public MemberInfoPrinter infoPrinter() {
		MemberInfoPrinter infoPrinter = new MemberInfoPrinter();
		return infoPrinter;
	}
	
	@Bean
	public VersionPrinter versionPrinter() {
		VersionPrinter versionPrinter = new VersionPrinter();
		versionPrinter.setMajorVersion(5);
		versionPrinter.setMinorVersion(0);
		return versionPrinter;
	}
}
```
 - Chapter4ì˜ ë¹„í•´ì„œ @Component ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ í´ë˜ìŠ¤ë¥¼ ê²€ìƒ‰í•´ì„œ ë¹ˆìœ¼ë¡œ ë“±ë¡í•´ì£¼ê¸° ë•Œë¬¸ì— ì„¤ì • ì½”ë“œê°€ ì¤„ì—ˆë‹¤.

### ìŠ¤ìº” ëŒ€ìƒì—ì„œ ì œì™¸í•˜ê±°ë‚˜ í¬í•¨í•˜ê¸°
> __excludeFilters ì†ì„±ì„ ì‚¬ìš©í•˜ë©´__ ìŠ¤ìº”í•  ë•Œ íŠ¹ì • ëŒ€ìƒì„ ìë™ ë“±ë¡ ëŒ€ìƒì—ì„œ ì œì™¸í•  ìˆ˜ ìˆë‹¤.

#### ğŸ”½ FilterType.REGEX : ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ì œì™¸ ëŒ€ìƒ ì§€ì •í•˜ê¸°
```java
package config;

import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.FilterType;
import org.springframework.context.annotation.ComponentScan.Filter;

import spring.MemberDao;
import spring.MemberPrinter;
import spring.MemberSummaryPrinter;
import spring.VersionPrinter;

@Configuration
@ComponentScan(basePackages = {"spring"}, 
	excludeFilters = @Filter(type = FilterType.REGEX, patter = "spring\\..*Dao" ))
public class AppCtxWithExclude {
	@Bean
	public MemberDao memberDao() {
		return new MemberDao();
	}
	
	@Bean
	@Qualifier("printer")
	public MemberPrinter memberPrinter1() {
		return new MemberPrinter();
	}

	@Bean
	@Qualifier("summaryPrinter")
	public MemberSummaryPrinter memberPrinter2() {
		return new MemberSummaryPrinter();
	}

	@Bean
	public VersionPrinter versionPrinter() {
		VersionPrinter versionPrinter = new VersionPrinter();
		versionPrinter.setMajorVersion(5);
		versionPrinter.setMinorVersion(0);
		return versionPrinter;
	}
}

```
 - ìœ„ ì½”ë“œëŠ @Filter ì• ë…¸í…Œì´ì…˜ì˜ type ì†ì„±ê°’ìœ¼ë¡œ FilterType.REGEXë¥¼ ì£¼ì—ˆë‹¤.
 - ì´ëŠ” ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•´ì„œ ì œì™¸ ëŒ€ìƒì„ ì§€ì •í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
 - "spring."ìœ¼ë¡œ ì‹œì‘í•˜ê³  Daoë¡œ ëë‚˜ëŠ” ì •ê·œí‘œí˜„ì‹ì„ ì§€ì •í–ˆìœ¼ë¯€ë¡œ spring.MemberDao í´ë˜ìŠ¤ëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì—ì„œ ì œì™¸í•œë‹¤.

#### ğŸ”½ FilterType.ASPECTJ : AspectJíŒ¨í„´ì„ ì‚¬ìš©í•´ì„œ ëŒ€ìƒ ì œì™¸í•˜ê¸°
````java
@Configuration
@ComponentScan(basePackage = {"spring"},
 excludeFilters = @Filter(type = FilterType.ASPECTJ, pattern = "spring.*Dao"))
public class AppCtxWithExclude {
    @Bean
    public MemberDao memberDao() {
        return new MemberDao();
    }
}
````
 - AspectJíŒ¨í„´ì€ spring íŒ¨í‚¤ì§€ì˜ Daoë¡œ ëë‚˜ëŠ” íƒ€ì…ì„ ì§€ì •í•œë‹¤.
 - spring íŒ¨í‚¤ì§€ì—ì„œ ì´ë¦„ì´ Daoë¡œ ëë‚˜ëŠ” íƒ€ì…ì„ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì—ì„œ ì œì™¸í•œë‹¤.
 - AspectJíŒ¨í„´ ì‚¬ìš©í•˜ë ¤ë©´ pom.xml ë˜ëŠ” build.gradleì— aspectjweaver ëª¨ë“ˆì„ ì¶”ê°€í•´ì•¼í•œë‹¤.

#### ğŸ”½ FilterType.ANNOTATION : ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì—¬ì„œ ëŒ€ìƒ ì œì™¸í•˜ê¸°
```java
@Configuration
@ComponentScan(basePackage = {"spring", "spring2"},
 excludeFilters = @Filter(type = FilterType.ANNOTATION, classes = {NoProduct.class, ManualBean.class}))
public class AppCtxWithExclude {
    @Bean
    public MemberDao memberDao() {
        return new MemberDao();
    }
}
```
 - @NoProductë‚˜ @ManualBeanì• ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ í´ë˜ìŠ¤ëŠ” ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì—ì„œ ì œì™¸ëœë‹¤.
 - classesì†ì„±ì— í•„í„°ë¡œ ì‚¬ìš©í•  ì• ë…¸í…Œì´ì…˜ì˜ íƒ€ì…ê°’ì„ ì¤€ë‹¤.

#### ğŸ”½ FilterType.ASSIGNABLE_TYPE : íŠ¹ì • íƒ€ì…ì´ë‚˜ ê·¸ í•˜ìœ„ íƒ€ì…ì„ ëŒ€ìƒ ì œì™¸í•˜ê¸°
```java
@Configuration
@ComponentScan(basePackage = {"spring"},
 excludeFilters = @Filter(type = FilterType.ASSIGNABLE_TYPE, classes = MemberDao.class))
public class AppCtxWithExclude {
    @Bean
    public MemberDao memberDao() {
        return new MemberDao();
    }
}
```
 - classes ì†ì„±ì— ì œì™¸í•  íƒ€ì… ëª©ë¡ì„ ì§€ì •í•œë‹¤.
 - ì œì™¸í•  íƒ€ì…ì´ 1ê°œì´ë¯€ë¡œ ë°°ì—´ì— í‘œê¸°í•˜ì§€ ì•Šì•˜ë‹¤. ex) ë°°ì—´í‘œê¸° : {arr, arr2} ì´ëŸ°ì‹ì´ë‹¤.

#### ë‘ê°œ ì´ìƒì˜ ì„¤ì • í•„í„° ì¸ê²½ìš° ë°°ì—´í˜•íƒœë¡œ ë„£ì–´ì¤€ë‹¤.
```java
@Configuration
@ComponentScan(basePackages = {"spring"}, 
	excludeFilters = { 
			@Filter(type = FilterType.ANNOTATION, classes = ManualBean.class ),
            @Filter(type = FilterType.REGEX, pattern = "spring2.\\..*")         
})
public class AppCtxWithExclude {
```

#### ê¸°ë³¸ ìŠ¤ìº” ëŒ€ìƒ
 > @Component ì• ë…¸í…Œì´ì…˜ì„ ë¶™ì¸ í´ë˜ìŠ¤ë§Œ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ëŒ€ìƒì— í¬í•¨ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

 > ê¸°ë³¸ì´ ë˜ëŠ” ëŒ€ìƒ
 - @Component
 - @Controller
 - @Service
 - @Repository
 - @Aspect
 - @Configuration

### ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì— ë”°ë¥¸ ì¶©ëŒ ì²˜ë¦¬
 - ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì„œ ìë™ìœ¼ë¡œ ë¹ˆì„ ë“±ë¡í•  ë•Œì—ëŠ” ì¶©ëŒì— ì£¼ì˜í•´ì•¼ í•œë‹¤.
 - ë¹ˆ ì´ë¦„ ì¶©ëŒê³¼ ìˆ˜ë™ ë“±ë¡ì— ë”°ë¥¸ ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

#### ë¹ˆ ì´ë¦„ ì¶©ëŒ
 > springíŒ¨í‚¤ì§€ì™€ spring2íŒ¨í‚¤ì§€ì— MemberRegisterService í´ë˜ìŠ¤ê°€ ëª¨ë‘ ì¡´ì¬í•˜ê³  @Component ì• ë…¸í…Œì´ì…˜ì„ ëª¨ë‘ ë¶™ì˜€ë‹¤ë©´?
```java
@Configuration
@ComponentScan(basePackages = {"spring", "spring2"})
public class AppCtx {
    ...
}
```
 - spring2 íŒ¨í‚¤ì§€ì˜ MemberRegisterServiceí´ë˜ìŠ¤ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡í•  ë•Œ ê¸°ì¡´ì˜ springíŒ¨í‚¤ì§€ì˜ ë™ì¼í•œ í´ë˜ìŠ¤ ë¹ˆì´ë¦„ ê³¼ ì¶©ëŒì´ë‚œë‹¤.
 - ì´ëŸ° ê²½ìš° ë‘˜ì¤‘ í•˜ë‚˜ë¥¼ ìˆ˜ë™ìœ¼ë¡œ @ComponentScan("registerService") ì´ëŸ°ì‹ìœ¼ë¡œ ë³€ê²½í•´ì£¼ì–´ì„œ ë¹ˆ(ë¹ˆê°ì²´)ì´ë¦„ ì¶©ëŒì„ í”¼í•´ì¤€ë‹¤.
 
#### ìˆ˜ë™ ë“±ë¡í•œ ë¹ˆê³¼ ì¶©ëŒ

#### ìŠ¤ìº”í•   ë•Œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ ì´ë¦„ ê³¼ ìˆ˜ë™ ë“±ë¡í•œ ë¹ˆ ì´ë¦„ì´ __ê°™ì€ ê²½ìš°!__

> ìë™ìœ¼ë¡œ ë¹ˆ ë“±ë¡ í•˜ëŠ” ë°©ë²•
```java
@Component
public class MemberDao {//ëª…ì‹œì ìœ¼ë¡œ ë³€ê²½í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë¹ˆ(ë¹ˆê°ì²´) ì´ë¦„ì€ memberDaoë¡œ ìƒì„±ëœë‹¤.
        
}
```
 > ìˆ˜ë™ìœ¼ë¡œ ë¹ˆì„ ë“±ë¡í•˜ëŠ” ë°©ë²•
```java

@Configuration
@ComponentScan(basePackages = {"spring", "spring2" })
public class AppCtxWithExclude {
    @Bean
    public MemberDao memberDao() {
        return new MemberDao();
    }
}
```
 - ìŠ¤ìº”í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ ì´ë¦„ê³¼ ìˆ˜ë™ ë“±ë¡í•œ ë¹ˆ ì´ë¦„ì´ ê°™ì€ ê²½ìš°
 - ìˆ˜ë™ ë“±ë¡í•œ ë¹ˆì„ ìš°ì„ ìœ¼ë¡œ í•œë‹¤.
 - __ì¦‰__ MemberDao íƒ€ì… ë¹ˆì€ AppCtxì—ì„œ ì •ì˜í•œ 1ê°œë§Œ ì¡´ì¬í•œë‹¤.
 
#### ìŠ¤ìº”í•   ë•Œ ì‚¬ìš©í•˜ëŠ” ë¹ˆ ì´ë¦„ ê³¼ ìˆ˜ë™ ë“±ë¡í•œ ë¹ˆ ì´ë¦„ì´ __ë‹¤ë¥¸ ê²½ìš°!__

> ìë™ìœ¼ë¡œ ë¹ˆ ë“±ë¡ í•˜ëŠ” ë°©ë²•
```java
@Component
public class MemberDao {//ëª…ì‹œì ìœ¼ë¡œ ë³€ê²½í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë¹ˆ(ë¹ˆê°ì²´) ì´ë¦„ì€ memberDaoë¡œ ìƒì„±ëœë‹¤.
        
}
```
> ìˆ˜ë™ìœ¼ë¡œ ë¹ˆ ë“±ë¡ í•˜ëŠ” ë°©ë²•

 ```java

@Configuration
@ComponentScan(basePackages = {"spring"})
public class AppCtxWithExclude {
    @Bean
    public MemberDao memberDao2() {
        MemberDao memberDao = new MemberDao();
        return memberDao;
    }
}
```
 - 2ê°œë‹¤ ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡í•œ ë¹ˆì´ì§€ë§Œ ê°™ì€ íƒ€ì…ì˜ ë‹¤ë¥¸ ì´ë¦„ì˜ ë¹ˆì¸ ê²½ìš°
 - ìŠ¤ìº”ì„ í†µí•´ ë“±ë¡í•œ memberDaoì™€ ìˆ˜ë™ìœ¼ë¡œ ë“±ë¡í•œ memberDao2 ë¹ˆì´ ëª¨ë‘ ì¡´ì¬í•œë‹¤.
 - MemberDao íƒ€ì…ì˜ ë¹ˆì´ 2ê°œê°€ ìƒì„±ë˜ë¯€ë¡œ ìë™ ì£¼ì…í•˜ëŠ” ì½”ë“œëŠ” @Qualifier(í•œì •ì)ë¥¼ ì´ìš©í•´ì„œ ì•Œë§ì€ ë¹ˆì„ ì„ íƒ í•´ì•¼í•œë‹¤.
