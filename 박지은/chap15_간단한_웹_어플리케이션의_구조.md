# 간단한 웹 어플리케이션의 구조

<br><Br>

## 구성요소

<br>

### 1. 프론트 서블릿

: 웹 브라우저의 모든 요청을 받는 창구 역할로, 요청을 분석해서 알맞은 컨트롤러에 전달

📌 spring MVC : DispatcherServlet

<br>

### 2. 컨트롤러 & 뷰

- 컨트롤러 : 클라이언트(브라우저)의 요청을 처리하기 위해 알맞은 기능을 실행하고 그 결과를 뷰에 전달

    - 클라이언트가 요구한 기능 실행
    - 응답 결과를 생성하는데 필요한 모델 생성
    - 응답 결과를 생성할 뷰 선택


➕ 컨트롤러는 ```어플리케이션의 기능```과 ```사용자 요청```을 연결하는 매개체로서, 기능 제공을 위한 로직 직접 수행 x

<BR>

### 3. 서비스

: 기능의 로직 구현

<bR>

### 4. DAO

: Data Access Object로 DB와 웹 어플리케이션 간 데이터를 이동시켜 주는 역할. 어플리케이션은 DAO를 통해 DB에 데이터를 추가하거나 DB에서 데이터를 읽어옴


➕ 서비스 메소드에서 어떤 로직도 수행하지 않고 단순히 DAO의 메소드만 호출하고 끝난다면 컨트롤러에서 바로 DAO 접근해도 됨!

<BR><bR>

## 서비스의 구현

- 서비스 : 핵심이 되는 기능의 로직 구현
    - 기능별로 서비스 클래스 작성
    - 같은 데이터를 사용하는 기능을 한 개의 서비스에 모아 서비스 클래스 작성


- 서비스 클래스의 메소드는 기능을 실행하는데 필요한 값을 파라미터로 받음 ➡️ 필요한 데이터를 전달받기 위해 스프링 MVC의 **커맨드 객체** 이용하면 편리!
    - 폼 값 바인딩과 검증
    - 스프링 폼 태그와 연동 기능


- 서비스 메소드의 기능 실행 후 결과 
    - 리턴 값을 이용한 정상 결과
    - 익셉션을 이용한 비정상 결과
        
        EX) 인증 로직 : 익셉션 발생 → 인증실패 → 이에 대한 대처


<br>

### 🔎 @Transactional

: 서비스의 로직을 수행할때 로직은 한번의 과정으로 끝나는 것이 아닌 몇단계의 과정을 거침. 이때, 중간 과정에서 실패가 나면 이전까지 했던 것을 취소해야 하고, **모든 과정을 성공적으로 진행했을때 완료**해야함

➡️ 서비스 메소드를 트랜잭션 범위에서 실행

```
@Transactional
    public void changePassword(String email, String oldPwd, String newPwd) {
        Member member = memberDao.selectByEmail(email);
        if (member == null)
            throw new MemberNotFoundException();

        member.changePassword(oldPwd, newPwd);

        memberDao.update(member);
    }
```